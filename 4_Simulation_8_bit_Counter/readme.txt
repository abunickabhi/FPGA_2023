Code imported from aravind and run in modelsim 10.5